{%- assign _class = 2 -%}
{%- assign _all = 6 -%}
{%- assign _row = 6 -%}
{%- assign _count = _acm_items | size -%}

{%- if _acm_limt < _count -%}
{%- assign _count = _acm_limt -%}
{%- endif -%}

<div class="box clearfix box-with-products with-scroll box-no-advanced">
  <!-- Carousel nav -->
  <a class="next" href="#myCarousel{{_id}}" id="myCarousel{{_id}}_next"><span></span></a>
  <a class="prev" href="#myCarousel{{_id}}" id="myCarousel{{_id}}_prev"><span></span></a>
  
  <div class="box-heading">{{_acm_title}}</div>
  <div class="strip-line"></div>

  <div class="clear"></div>
  <div class="box-content products">
    <div class="box-product">
      <div id="myCarousel{{_id}}" class="carousel slide">
        <div class="carousel-inner">
          {%- assign _i = 0 -%}
          {%- assign _row_fluid = 0 -%}
          {%- assign _item = 0 -%}

          {%- for _item in _acm_items -%}
          {%- if _item.type == 'product_link' -%}

          {%- if _i == _acm_limit -%}
          {%- break -%}
          {%- endif -%}

          {%- assign _row_fluid = _row_fluid | plus: 1 -%}

          {%- if _i == 0 -%}
          {%- assign _item = _item | plus: 1 -%}{{' '}}
          <div class="active item">
            <div class="product-grid">
              <div class="row">
                {%- endif -%}

                {%- assign _r = _row_fluid | divided_by: _all -%}
                {%- assign _r = _r | times: _all -%}
                {%- assign _r = _row_fluid | minus: _r -%}

                {%- if _row_fluid > _all and _r == 1 -%}{{' '}}
              </div>
            </div>
          </div>
          <div class="item">
            <div class="product-grid">
              <div class="row">
                {%- assign _item = _item | plus: 1 -%}{{' '}}
                {%- else -%}

                {%- assign _r = _row_fluid | divided_by: _row -%}
                {%- assign _r = _r | times: _row -%}
                {%- assign _r = _row_fluid | minus: _r -%}

                {%- if _row_fluid > _row and _r == 1 -%}{{' '}}
              </div>
              <div class="row">
                {%- endif -%}
                {%- endif -%}

                <div class="col-sm-{{_class}} col-xs-6{%- if _class == 2 -%}{{' '}}col-md-25 col-lg-2 col-sm-3{%- endif -%}{%- if _class == 2 and _r == 0 -%}{{' '}}hidden-md hidden-sm{%- endif -%}{%- if _class == 2 and _r == 5 -%}{{' '}}hidden-sm{%- endif -%}{%- if _class == 25 -%}{{' '}}col-md-25 col-lg-25 col-sm-3{%- endif -%}{%- if _class == 25 and _r == 0 -%}{{' '}}hidden-sm{%- endif -%}">
                  {%- assign product = _item.object -%}
                  {%- include 'product-item' -%}
                </div>
                {%- assign _i = _i | plus: 1 -%}
                {%- endif -%}
                {%- endfor -%}

                {%- if _i > 0 -%}
              </div>
            </div>
          </div>
          {%- endif -%}
        </div>
      </div>
    </div>
  </div>
</div>

<script type="text/javascript">
  $(document).ready(function() {
    var owl{{_id}} = $(".box #myCarousel{{_id}} .carousel-inner");
    $("#myCarousel{{_id}}_next").click(function(){
      owl{{_id}}.trigger('next.owl.carousel');
      return false;
    })
  
    $("#myCarousel{{_id}}_prev").click(function(){
      owl{{_id}}.trigger('prev.owl.carousel');
      return false;
    });

    owl{{_id}}.owlCarousel({
      slideSpeed : 500,
      items:1,
      rtl: window.rtl
    });
  });
</script>